clear all
close all
model_dire = '../Models/';
WP_file = [model_dire, 'MNISTWP.txt'];
WB_file = [model_dire, 'MNISTWB.txt'];
WC_file = [model_dire, 'MNISTWC.txt'];

WP=load(WP_file);
WB=load(WB_file);
WC=load(WC_file);

S = 500;
[xd, hk] = Gibbs_sampler(WP, WB, WC, S);

index = 1:500;
disp(size(xd))
Y = xd(mod(index,5)==0, :);


disp(size(Y))
GridImg = make_grid_image(Y,28,28,10,10,0.5);
imagesc(GridImg);
axis square;
axis off;

%%
clear all
close all
model_dire = '../Models/';
WP_file = [model_dire, 'MNISTWP.txt'];
WB_file = [model_dire, 'MNISTWB.txt'];
WC_file = [model_dire, 'MNISTWC.txt'];

WP=load(WP_file);
WB=load(WB_file);
WC=load(WC_file);

S = 500;
C = 100;

Y = [];

energy_trace = cell(1, 5);

for i=1:C
    [xd, hk] = Gibbs_sampler(WP, WB, WC, S);
    Y = [Y; xd(S, :)];
    if i <= 5
        energy_trace{i} = -(xd*(WP*hk'))'-WB*hk'-WC*xd';
    end
end

disp(size(Y))
GridImg = make_grid_image(Y,28,28,10,10,0.5);
imagesc(GridImg);
axis square;
axis off;

X = 1:S
mark = ['']
for i=1:5
    
end